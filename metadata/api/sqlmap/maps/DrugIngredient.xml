<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap
	PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
	"http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="org.openmrs.DrugIngredient">

<!-- ************************************************************ -->
<!-- ** Creation                                               ** -->
<!-- ************************************************************ -->

<insert id="createDrugIngredient" parameterClass="org.openmrs.DrugIngredient">
	INSERT INTO drug_ingredient
		(
		concept_id,
		ingredient_id
		)
	VALUES
		(
		#drug.conceptId#,
		#ingredient.conceptId#
		);
</insert>

<!-- ************************************************************ -->
<!-- ** Read                                                   ** -->
<!-- ************************************************************ -->

<resultMap id="drugIngredientResult" class="org.openmrs.DrugIngredient">
	<result property="drug" column="concept_id" select="getConcept" />
	<result property="ingredient" column="ingredient_id" select="getConcept" />
</resultMap>

<select id="getDrugIngredient" parameterClass="org.openmrs.DrugIngredient"
        resultMap="drugIngredientResult">
	SELECT * FROM drug_ingredient
	WHERE
		concept_id = #drug.conceptId# AND
		ingredient = #ingredient.conceptId#
</select>

<select id="getDrugIngredientByConceptId" parameterClass="int"
        resultMap="drugIngredientResult">
	SELECT * FROM drug_ingredient WHERE concept_id = #value#
</select>

<!-- ************************************************************ -->
<!-- ** Update                                                 ** -->
<!-- ************************************************************ -->

<!-- ************************************************************ -->
<!-- ** Deletion                                               ** -->
<!-- ************************************************************ -->

<delete id="deleteDrugIngredient" parameterClass="org.openmrs.DrugIngredient">
	DELETE FROM drug_ingredient
	WHERE
		concept_id = #drug.conceptId# AND
		ingredient = #ingredient.conceptId#
</delete>

</sqlMap>